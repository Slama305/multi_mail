{"version":3,"file":"node-build.mjs","sources":["../../server/routes/demo.ts","../../server/utils/mailer.ts","../../server/routes/send-email.ts","../../shared/api.ts","../../server/routes/bulk-send-email.ts","../../server/index.ts","../../server/node-build.ts"],"sourcesContent":["import { RequestHandler } from \"express\";\nimport { DemoResponse } from \"@shared/api\";\n\nexport const handleDemo: RequestHandler = (req, res) => {\n  const response: DemoResponse = {\n    message: \"Hello from Express server\",\n  };\n  res.status(200).json(response);\n};\n","import nodemailer from \"nodemailer\";\n\ninterface SendEmailOptions {\n  to: string;\n  recipientName: string;\n  subject: string;\n  html: string;\n  gmailEmail?: string;\n  appPassword?: string;\n}\n\ninterface SendEmailResult {\n  messageId: string;\n}\n\nasync function createTransporter(gmailEmail?: string, appPassword?: string) {\n  if (gmailEmail && appPassword) {\n    return nodemailer.createTransport({\n      service: \"gmail\",\n      auth: { user: gmailEmail, pass: appPassword },\n    });\n  }\n\n  const smtpHost = process.env.SMTP_HOST;\n  const smtpPort = process.env.SMTP_PORT;\n  const smtpUser = process.env.SMTP_USER;\n  const smtpPassword = process.env.SMTP_PASSWORD;\n\n  if (smtpHost && smtpPort && smtpUser && smtpPassword) {\n    return nodemailer.createTransport({\n      host: smtpHost,\n      port: parseInt(smtpPort),\n      secure: process.env.SMTP_SECURE === \"true\",\n      auth: { user: smtpUser, pass: smtpPassword },\n    });\n  }\n\n  console.warn(\"No SMTP credentials found. Using Ethereal Email for testing.\");\n  const testAccount = await nodemailer.createTestAccount();\n  return nodemailer.createTransport({\n    host: \"smtp.ethereal.email\",\n    port: 587,\n    secure: false,\n    auth: { user: testAccount.user, pass: testAccount.pass },\n  });\n}\n\nexport async function sendEmailWithNodemailer(\n  options: SendEmailOptions,\n): Promise<SendEmailResult> {\n  try {\n    const transporter = await createTransporter(options.gmailEmail, options.appPassword);\n\n    const fromEmail = options.gmailEmail || process.env.FROM_EMAIL || \"noreply@emailtemplates.app\";\n    const fromName = process.env.FROM_NAME || \"Email Templates\";\n\n    const info = await transporter.sendMail({\n      from: `\"${fromName}\" <${fromEmail}>`,\n      to: `\"${options.recipientName}\" <${options.to}>`,\n      subject: options.subject,\n      html: options.html,\n    });\n\n    if (process.env.NODE_ENV !== \"production\") {\n      console.log(\"Preview URL:\", nodemailer.getTestMessageUrl(info));\n    }\n\n    return { messageId: info.messageId || \"sent\" };\n  } catch (error) {\n    console.error(\"Failed to send email:\", error);\n    throw error;\n  }\n}\n","import { RequestHandler } from \"express\";\nimport { SendEmailRequest, SendEmailResponse } from \"@shared/api\";\nimport { sendEmailWithNodemailer } from \"../utils/mailer\";\n\nexport const handleSendEmail: RequestHandler = async (req, res) => {\n  try {\n    const payload = req.body as SendEmailRequest;\n\n    // Validation\n    if (!payload.recipientEmail || !payload.subject || !payload.content) {\n      res.status(400).json({\n        success: false,\n        message: \"Missing required fields: recipientEmail, subject, content\",\n      } as SendEmailResponse);\n      return;\n    }\n\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(payload.recipientEmail)) {\n      res.status(400).json({\n        success: false,\n        message: \"Invalid email format\",\n      } as SendEmailResponse);\n      return;\n    }\n\n    // Use Gmail credentials from session or request body\n    const credentialsStr =\n      req.session?.gmailCredentials || req.body?.gmailCredentials;\n    if (!credentialsStr) throw new Error(\"Gmail credentials not found\");\n    const { email: gmailEmail, password: appPassword } = JSON.parse(credentialsStr);\n\n    const result = await sendEmailWithNodemailer({\n      to: payload.recipientEmail,\n      recipientName: payload.recipientName,\n      subject: payload.subject,\n      html: payload.content,\n      gmailEmail,\n      appPassword,\n    });\n\n    res.json({\n      success: true,\n      message: \"Email sent successfully\",\n      messageId: result.messageId,\n    } as SendEmailResponse);\n  } catch (error) {\n    console.error(\"Error sending email:\", error);\n    res.status(500).json({\n      success: false,\n      message: error instanceof Error ? error.message : \"Failed to send email\",\n    } as SendEmailResponse);\n  }\n};\n","export interface DemoResponse {\n  message: string;\n}\n\nexport interface EmailTemplate {\n  id: string;\n  name: string;\n  category: string;\n  subject: string;\n  preview: string;\n  content: string;\n  icon: string;\n}\n\nexport interface SendEmailRequest {\n  recipientEmail: string;\n  recipientName: string;\n  subject: string;\n  content: string;\n  templateId: string;\n}\n\nexport interface SendEmailResponse {\n  success: boolean;\n  message: string;\n  messageId?: string;\n}\n\nexport interface BulkEmailRequest {\n  recipients: Array<{\n    name: string;\n    email: string;\n  }>;\n  subject: string;\n  content: string;\n  templateId: string;\n  gmailEmail: string;\n  appPassword: string;\n}\n\nexport interface BulkEmailResponse {\n  success: boolean;\n  message: string;\n  totalSent: number;\n  totalFailed: number;\n  results: Array<{\n    email: string;\n    name: string;\n    success: boolean;\n    error?: string;\n  }>;\n}\n\nexport const EMAIL_TEMPLATES: EmailTemplate[] = [\n  {\n    id: \"invitation\",\n    name: \"Event Invitation\",\n    category: \"Events\",\n    subject: \"You're Invited! Join us for an Amazing Event\",\n    preview:\n      \"We'd love to have you at our upcoming event. Join us for a memorable experience...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #2c3e50; margin-bottom: 20px;\">You're Invited!</h2>\n    <p>Dear [Guest Name],</p>\n    <p>We're delighted to invite you to our upcoming event. We hope you can join us for an unforgettable experience filled with great company, interesting conversations, and memorable moments.</p>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-left: 4px solid #3498db; margin: 20px 0;\">\n      <p><strong>Event Details:</strong></p>\n      <p>Date: [Date]<br>Time: [Time]<br>Location: [Location]</p>\n    </div>\n    <p>Please let us know if you can attend by replying to this email.</p>\n    <p>Looking forward to seeing you there!</p>\n    <p>Best regards,<br>The Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üìß\",\n  },\n  {\n    id: \"acceptance\",\n    name: \"Application Acceptance\",\n    category: \"HR\",\n    subject: \"Congratulations! Your Application Has Been Accepted\",\n    preview:\n      \"Great news! We're excited to offer you the position. Here's what's next...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #27ae60; margin-bottom: 20px;\">üéâ Congratulations!</h2>\n    <p>Dear [Candidate Name],</p>\n    <p>We are thrilled to inform you that your application has been accepted! We believe you're a great fit for our team and we can't wait to work with you.</p>\n    <div style=\"background-color: #f0f8f4; padding: 15px; border-left: 4px solid #27ae60; margin: 20px 0;\">\n      <p><strong>Next Steps:</strong></p>\n      <p>1. Review the attached offer letter<br>2. Sign and return the contract<br>3. Complete onboarding forms<br>4. Schedule your start date</p>\n    </div>\n    <p>If you have any questions, please don't hesitate to reach out. We're here to help make your transition smooth.</p>\n    <p>Welcome to our team!<br>Best regards,<br>Human Resources Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"‚úÖ\",\n  },\n  {\n    id: \"rejection\",\n    name: \"Application Rejection\",\n    category: \"HR\",\n    subject: \"Thank You For Your Application\",\n    preview:\n      \"We appreciate your interest. While we won't be moving forward at this time...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #2c3e50; margin-bottom: 20px;\">Thank You For Your Application</h2>\n    <p>Dear [Candidate Name],</p>\n    <p>Thank you for taking the time to apply and for your interest in joining our organization. We genuinely appreciate the effort you put into your application.</p>\n    <p>After careful consideration, we have decided to move forward with other candidates whose backgrounds more closely match our current needs. This decision does not reflect your qualifications or potential.</p>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-left: 4px solid #95a5a6; margin: 20px 0;\">\n      <p><strong>We Encourage You To:</strong></p>\n      <p>‚Ä¢ Keep an eye on our careers page for future opportunities<br>‚Ä¢ Connect with us on LinkedIn<br>‚Ä¢ Feel free to reapply in the future</p>\n    </div>\n    <p>We wish you the best of luck in your career journey!</p>\n    <p>Best regards,<br>Recruitment Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üìã\",\n  },\n  {\n    id: \"winning\",\n    name: \"Contest Winner Notification\",\n    category: \"Marketing\",\n    subject: \"üèÜ You've Won! Claim Your Prize Today\",\n    preview:\n      \"Congratulations! You've been selected as the winner of our contest...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #f39c12; margin-bottom: 20px;\">üèÜ You're a Winner!</h2>\n    <p>Dear [Winner Name],</p>\n    <p>Exciting news! You've been selected as the grand prize winner of our [Contest Name]! Congratulations on this amazing achievement!</p>\n    <div style=\"background-color: #fffbea; padding: 15px; border-left: 4px solid #f39c12; margin: 20px 0;\">\n      <p><strong>Your Prize:</strong></p>\n      <p>[Prize Description and Details]</p>\n      <p style=\"margin-top: 15px;\"><strong>Prize Value: [Amount]</strong></p>\n    </div>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>Claim Your Prize:</strong></p>\n      <p>To claim your prize, please click the button below or reply to this email with your confirmation.</p>\n      <a href=\"[claim_link]\" style=\"display: inline-block; background-color: #f39c12; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; margin-top: 10px;\">Claim Your Prize</a>\n    </div>\n    <p>Thank you for your participation. We hope to see you in our next contest!</p>\n    <p>Best regards,<br>Contest Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üèÜ\",\n  },\n  {\n    id: \"alert\",\n    name: \"Security Alert\",\n    category: \"Security\",\n    subject: \"‚ö†Ô∏è Security Alert - Unusual Activity Detected\",\n    preview:\n      \"We've detected unusual activity on your account. Please review this immediately...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #e74c3c; margin-bottom: 20px;\">‚ö†Ô∏è Security Alert</h2>\n    <p>Dear [User Name],</p>\n    <p>We've detected some unusual activity on your account that requires your immediate attention.</p>\n    <div style=\"background-color: #ffe6e6; padding: 15px; border-left: 4px solid #e74c3c; margin: 20px 0;\">\n      <p><strong>Alert Details:</strong></p>\n      <p>Activity: [Activity Type]<br>Location: [Location]<br>Time: [Time]<br>Device: [Device Info]</p>\n    </div>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>If this was you:</strong> No action is needed. You can safely close this email.</p>\n      <p><strong>If this wasn't you:</strong> Please secure your account immediately:</p>\n      <ol>\n        <li>Change your password</li>\n        <li>Enable two-factor authentication</li>\n        <li>Review recent activity</li>\n        <li>Contact our support team</li>\n      </ol>\n    </div>\n    <p>Thank you for keeping your account secure!</p>\n    <p>Best regards,<br>Security Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üîí\",\n  },\n  {\n    id: \"welcome\",\n    name: \"Welcome Email\",\n    category: \"Onboarding\",\n    subject: \"Welcome to Our Platform!\",\n    preview:\n      \"We're excited to have you join our community. Here's how to get started...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #3498db; margin-bottom: 20px;\">Welcome Aboard! üöÄ</h2>\n    <p>Hi [User Name],</p>\n    <p>We're thrilled to have you join our community! Whether you're here to [purpose], you're in the right place.</p>\n    <div style=\"background-color: #f0f7ff; padding: 15px; border-left: 4px solid #3498db; margin: 20px 0;\">\n      <p><strong>Getting Started:</strong></p>\n      <p>1. Complete your profile<br>2. Explore our features<br>3. Check out our tutorial<br>4. Connect with other users</p>\n    </div>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>Quick Links:</strong></p>\n      <p><a href=\"[docs_link]\" style=\"color: #3498db; text-decoration: none;\">Documentation</a> | <a href=\"[help_link]\" style=\"color: #3498db; text-decoration: none;\">Help Center</a> | <a href=\"[community_link]\" style=\"color: #3498db; text-decoration: none;\">Community</a></p>\n    </div>\n    <p>If you have any questions, feel free to reach out. We're always happy to help!</p>\n    <p>Best regards,<br>The Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üëã\",\n  },\n  {\n    id: \"reminder\",\n    name: \"Event Reminder\",\n    category: \"Events\",\n    subject: \"Don't Forget! Your Event Starts Tomorrow\",\n    preview:\n      \"Just a friendly reminder about the upcoming event. Here are the details...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #9b59b6; margin-bottom: 20px;\">‚è∞ Event Reminder</h2>\n    <p>Hi [Name],</p>\n    <p>This is a friendly reminder about the upcoming event you're registered for. We can't wait to see you there!</p>\n    <div style=\"background-color: #f5f0ff; padding: 15px; border-left: 4px solid #9b59b6; margin: 20px 0;\">\n      <p><strong>Event Details:</strong></p>\n      <p><strong>When:</strong> [Date] at [Time]<br><strong>Where:</strong> [Location]<br><strong>Duration:</strong> [Duration]</p>\n    </div>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>What to Bring/Do:</strong></p>\n      <p>[Preparation Instructions]</p>\n    </div>\n    <p>If you need to reschedule or have questions, please let us know ASAP.</p>\n    <p>See you soon!<br>Best regards,<br>Event Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üìÖ\",\n  },\n  {\n    id: \"feedback\",\n    name: \"Feedback Request\",\n    category: \"Survey\",\n    subject: \"We'd Love Your Feedback\",\n    preview:\n      \"Your opinion matters! Help us improve by sharing your thoughts...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #16a085; margin-bottom: 20px;\">üìù Your Feedback Matters</h2>\n    <p>Dear [Customer Name],</p>\n    <p>We value your opinion and would love to hear about your experience with our product/service. Your feedback helps us improve and serve you better.</p>\n    <div style=\"background-color: #f0fdfb; padding: 15px; border-left: 4px solid #16a085; margin: 20px 0;\">\n      <p><strong>Quick Survey:</strong></p>\n      <p>It only takes 2-3 minutes to complete and your input is invaluable to us.</p>\n      <a href=\"[survey_link]\" style=\"display: inline-block; background-color: #16a085; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; margin-top: 10px;\">Take Survey</a>\n    </div>\n    <p>Thank you for choosing us and for taking the time to help us improve!</p>\n    <p>Best regards,<br>Customer Success Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üí¨\",\n  },\n  {\n    id: \"receipt\",\n    name: \"Order Receipt\",\n    category: \"Orders\",\n    subject: \"Order Confirmation #[Order ID]\",\n    preview:\n      \"Thank you for your purchase! Here's your order confirmation and receipt...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #2c3e50; margin-bottom: 20px;\">Order Confirmation</h2>\n    <p>Dear [Customer Name],</p>\n    <p>Thank you for your purchase! Your order has been confirmed and is being prepared for shipment.</p>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>Order Details:</strong></p>\n      <p>Order ID: [Order ID]<br>Date: [Date]<br>Total: [Amount]</p>\n      <p style=\"margin-top: 15px;\"><strong>Items:</strong></p>\n      <p>[Product List with quantities and prices]</p>\n    </div>\n    <div style=\"background-color: #f0f7ff; padding: 15px; border-left: 4px solid #3498db; margin: 20px 0;\">\n      <p><strong>Shipping Information:</strong></p>\n      <p>Estimated Delivery: [Date Range]<br>Tracking Number: [Tracking #]</p>\n    </div>\n    <p>You can track your order status anytime by visiting your account.</p>\n    <p>Thank you for your business!</p>\n    <p>Best regards,<br>Order Management Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üì¶\",\n  },\n  {\n    id: \"password-reset\",\n    name: \"Password Reset\",\n    category: \"Security\",\n    subject: \"Reset Your Password\",\n    preview:\n      \"We received a request to reset your password. Click the link below to set a new one...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #2c3e50; margin-bottom: 20px;\">Password Reset Request</h2>\n    <p>Hello,</p>\n    <p>We received a request to reset your password. If you did not make this request, you can ignore this email.</p>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>To reset your password:</strong></p>\n      <p>Click the button below to create a new password. This link will expire in 24 hours.</p>\n      <a href=\"[reset_link]\" style=\"display: inline-block; background-color: #3498db; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; margin-top: 10px;\">Reset Password</a>\n    </div>\n    <p style=\"color: #7f8c8d; font-size: 12px;\">If you didn't request this, no action is needed. Your password will remain unchanged.</p>\n    <p>Best regards,<br>Security Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üîë\",\n  },\n  {\n    id: \"notification\",\n    name: \"General Notification\",\n    category: \"Updates\",\n    subject: \"Important Update From Us\",\n    preview:\n      \"We have an important update to share with you. Please read below...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #2c3e50; margin-bottom: 20px;\">üì¢ Important Update</h2>\n    <p>Dear [User Name],</p>\n    <p>We wanted to keep you informed about some important changes in our service.</p>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-left: 4px solid #3498db; margin: 20px 0;\">\n      <p><strong>What's Changing:</strong></p>\n      <p>[Detailed change description]</p>\n    </div>\n    <div style=\"background-color: #f0f7ff; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>When:</strong> [Date]<br><strong>Impact:</strong> [How it affects users]<br><strong>What You Need To Do:</strong> [Action items if any]</p>\n    </div>\n    <p>If you have any questions, please don't hesitate to contact us.</p>\n    <p>Best regards,<br>The Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üì¨\",\n  },\n  {\n    id: \"invoice\",\n    name: \"Invoice\",\n    category: \"Finance\",\n    subject: \"Invoice #[Invoice ID] From [Company Name]\",\n    preview:\n      \"Your invoice is ready. Please find the details and payment options below...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #2c3e50; margin-bottom: 20px;\">Invoice</h2>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>Invoice #:</strong> [Invoice ID]<br><strong>Invoice Date:</strong> [Date]<br><strong>Due Date:</strong> [Date]</p>\n    </div>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>Bill To:</strong></p>\n      <p>[Customer Name]<br>[Company Name]<br>[Address]</p>\n    </div>\n    <table style=\"width: 100%; border-collapse: collapse; margin: 20px 0;\">\n      <thead>\n        <tr style=\"background-color: #ecf0f1;\">\n          <th style=\"border: 1px solid #ddd; padding: 10px; text-align: left;\">Description</th>\n          <th style=\"border: 1px solid #ddd; padding: 10px; text-align: right;\">Quantity</th>\n          <th style=\"border: 1px solid #ddd; padding: 10px; text-align: right;\">Unit Price</th>\n          <th style=\"border: 1px solid #ddd; padding: 10px; text-align: right;\">Total</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td style=\"border: 1px solid #ddd; padding: 10px;\">[Item Description]</td>\n          <td style=\"border: 1px solid #ddd; padding: 10px; text-align: right;\">[Qty]</td>\n          <td style=\"border: 1px solid #ddd; padding: 10px; text-align: right;\">[Price]</td>\n          <td style=\"border: 1px solid #ddd; padding: 10px; text-align: right;\">[Total]</td>\n        </tr>\n      </tbody>\n    </table>\n    <div style=\"background-color: #ecf0f1; padding: 15px; border-radius: 4px; text-align: right;\">\n      <p><strong>Subtotal:</strong> [Amount]<br><strong>Tax:</strong> [Amount]<br><strong style=\"font-size: 16px;\">Total Due: [Amount]</strong></p>\n    </div>\n    <p style=\"margin-top: 20px;\">Please remit payment by [Due Date]. Thank you for your business!</p>\n    <p>Best regards,<br>[Company Name]</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üí∞\",\n  },\n  {\n    id: \"birthday\",\n    name: \"Birthday Greeting\",\n    category: \"Personal\",\n    subject: \"üéâ Happy Birthday [Name]!\",\n    preview:\n      \"Wishing you a wonderful birthday filled with joy and celebration...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;\">\n    <h2 style=\"margin-bottom: 20px; text-align: center;\">üéâ Happy Birthday!</h2>\n    <p style=\"text-align: center; font-size: 18px;\">Dear [Name],</p>\n    <p style=\"text-align: center; margin: 20px 0;\">On your special day, we want to wish you all the happiness, joy, and success that you deserve. May this year bring you wonderful moments and memorable experiences!</p>\n    <div style=\"background-color: rgba(255, 255, 255, 0.1); padding: 15px; border-radius: 4px; margin: 20px 0; text-align: center;\">\n      <p>üéÇ Enjoy your special day üéÇ</p>\n    </div>\n    <p style=\"text-align: center; margin-top: 20px;\">Cheers to another year of greatness!<br><br>Warmest regards,<br>The Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üéÇ\",\n  },\n  {\n    id: \"apology\",\n    name: \"Apology/Service Recovery\",\n    category: \"Support\",\n    subject: \"We Apologize - Here's How We're Making It Right\",\n    preview:\n      \"We sincerely apologize for the inconvenience. Here's what we're doing to fix it...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #e74c3c; margin-bottom: 20px;\">We Sincerely Apologize</h2>\n    <p>Dear [Customer Name],</p>\n    <p>We deeply apologize for the recent issue you experienced with [service/product]. We understand how frustrating this must have been, and we take full responsibility.</p>\n    <div style=\"background-color: #ffe6e6; padding: 15px; border-left: 4px solid #e74c3c; margin: 20px 0;\">\n      <p><strong>What Went Wrong:</strong></p>\n      <p>[Honest explanation of the issue]</p>\n    </div>\n    <div style=\"background-color: #f0f7ff; padding: 15px; border-left: 4px solid #3498db; margin: 20px 0;\">\n      <p><strong>Here's What We're Doing:</strong></p>\n      <p>1. [Action item 1]<br>2. [Action item 2]<br>3. [Action item 3]</p>\n    </div>\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 20px 0;\">\n      <p><strong>Your Compensation:</strong></p>\n      <p>[Details of service recovery offer]</p>\n    </div>\n    <p>Thank you for your patience and understanding. We're committed to regaining your trust.</p>\n    <p>Best regards,<br>Customer Care Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üôè\",\n  },\n  {\n    id: \"newsletter\",\n    name: \"Newsletter\",\n    category: \"Marketing\",\n    subject: \"Your Monthly Newsletter - [Month] Edition\",\n    preview:\n      \"Check out the latest updates, news, and insights from this month...\",\n    content: `<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n    <h2 style=\"color: #2c3e50; margin-bottom: 20px;\">üì∞ Monthly Newsletter</h2>\n    <p>Hi [Subscriber Name],</p>\n    <p>Welcome to our [Month] newsletter! This month, we're sharing exciting updates, valuable insights, and exclusive content just for our subscribers.</p>\n\n    <div style=\"background-color: #f8f9fa; padding: 15px; border-left: 4px solid #3498db; margin: 20px 0;\">\n      <h3 style=\"margin-top: 0; color: #2c3e50;\">üìå Featured Article</h3>\n      <p><strong>[Article Title]</strong></p>\n      <p>[Article summary goes here...]</p>\n      <a href=\"[article_link]\" style=\"color: #3498db; text-decoration: none; font-weight: bold;\">Read More ‚Üí</a>\n    </div>\n\n    <div style=\"background-color: #f0fdfb; padding: 15px; border-left: 4px solid #16a085; margin: 20px 0;\">\n      <h3 style=\"margin-top: 0; color: #2c3e50;\">üí° This Month's Tips</h3>\n      <ul style=\"padding-left: 20px;\">\n        <li>[Tip 1: Brief description]</li>\n        <li>[Tip 2: Brief description]</li>\n        <li>[Tip 3: Brief description]</li>\n      </ul>\n    </div>\n\n    <div style=\"background-color: #fff5f0; padding: 15px; border-left: 4px solid #e67e22; margin: 20px 0;\">\n      <h3 style=\"margin-top: 0; color: #2c3e50;\">üåü Community Spotlight</h3>\n      <p>[Feature a community member or success story here...]</p>\n    </div>\n\n    <div style=\"background-color: #ecf0f1; padding: 15px; border-radius: 4px; margin: 20px 0; text-align: center;\">\n      <a href=\"[view_online_link]\" style=\"display: inline-block; background-color: #3498db; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;\">View in Browser</a>\n    </div>\n\n    <p style=\"color: #7f8c8d; font-size: 12px;\">You're receiving this because you subscribed to our newsletter. <a href=\"[unsubscribe_link]\" style=\"color: #7f8c8d;\">Unsubscribe</a></p>\n    <p>Best regards,<br>The Team</p>\n  </div>\n</body>\n</html>`,\n    icon: \"üì∞\",\n  },\n];\n","import { RequestHandler } from \"express\";\nimport nodemailer from \"nodemailer\";\nimport { BulkEmailRequest, BulkEmailResponse, EMAIL_TEMPLATES } from \"../../shared/api\";\nimport { sendEmailWithNodemailer } from \"../utils/mailer\";\n\nexport const handleBulkSendEmail: RequestHandler = async (req, res) => {\n  try {\n    const payload = req.body as BulkEmailRequest;\n\n    if (!payload.recipients?.length)\n      return res.status(400).json({\n        success: false,\n        message: \"No recipients provided\",\n        totalSent: 0,\n        totalFailed: 0,\n        results: [],\n      } as BulkEmailResponse);\n\n    if (!payload.subject || !payload.content || !payload.gmailEmail || !payload.appPassword)\n      return res.status(400).json({\n        success: false,\n        message: \"Missing required fields\",\n        totalSent: 0,\n        totalFailed: 0,\n        results: [],\n      } as BulkEmailResponse);\n\n    const results: any[] = [];\n    let successCount = 0, failureCount = 0;\n\n    const template = EMAIL_TEMPLATES.find((t) => t.id === payload.templateId);\n    if (!template)\n      return res.status(400).json({\n        success: false,\n        message: \"Template not found\",\n        totalSent: 0,\n        totalFailed: 0,\n        results: [],\n      } as BulkEmailResponse);\n\n    for (const recipient of payload.recipients) {\n      try {\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(recipient.email)) {\n          results.push({\n            email: recipient.email,\n            name: recipient.name,\n            success: false,\n            error: \"Invalid email format\",\n          });\n          failureCount++;\n          continue;\n        }\n\n        const personalizedContent = payload.content.replace(/\\[([^\\]]+)\\]/g, (_, key) => {\n          const normalizedKey = key.trim().toLowerCase().replace(/\\s+/g, \"\");\n          let matchKey = Object.keys(recipient).find(\n            (k) => k.toLowerCase().replace(/\\s+/g, \"\") === normalizedKey,\n          );\n\n          if (!matchKey) {\n            matchKey = Object.keys(recipient).find((k) => {\n              const col = k.toLowerCase().replace(/\\s+/g, \"\");\n              return col.includes(normalizedKey) || normalizedKey.includes(col);\n            });\n          }\n\n          return matchKey ? String(recipient[matchKey as keyof typeof recipient]) : `[${key}]`;\n        });\n\n        await sendEmailWithNodemailer({\n          to: recipient.email,\n          recipientName: recipient.name,\n          subject: payload.subject,\n          html: personalizedContent,\n          gmailEmail: payload.gmailEmail,\n          appPassword: payload.appPassword,\n        });\n\n        results.push({ email: recipient.email, name: recipient.name, success: true });\n        successCount++;\n      } catch (error) {\n        results.push({\n          email: recipient.email,\n          name: recipient.name,\n          success: false,\n          error: error instanceof Error ? error.message : \"Unknown error\",\n        });\n        failureCount++;\n      }\n    }\n\n    res.json({\n      success: successCount > 0,\n      message: `Sent ${successCount} emails, ${failureCount} failed`,\n      totalSent: successCount,\n      totalFailed: failureCount,\n      results,\n    } as BulkEmailResponse);\n  } catch (error) {\n    console.error(\"Error sending bulk emails:\", error);\n    res.status(500).json({\n      success: false,\n      message: error instanceof Error ? error.message : \"Failed to send emails\",\n      totalSent: 0,\n      totalFailed: 0,\n      results: [],\n    } as BulkEmailResponse);\n  }\n};\n","import \"dotenv/config\";\nimport express from \"express\";\nimport cors from \"cors\";\nimport { handleDemo } from \"./routes/demo\";\nimport { handleSendEmail } from \"./routes/send-email\";\nimport { handleBulkSendEmail } from \"./routes/bulk-send-email\";\n\nexport function createServer() {\n  const app = express();\n\n  // Middleware\n  app.use(cors());\n  app.use(express.json({ limit: \"50mb\" }));\n  app.use(express.urlencoded({ extended: true, limit: \"50mb\" }));\n\n  // API routes\n  app.get(\"/api/ping\", (_req, res) => {\n    const ping = process.env.PING_MESSAGE ?? \"ping\";\n    res.json({ message: ping });\n  });\n\n  app.get(\"/api/demo\", handleDemo);\n  app.post(\"/api/send-email\", handleSendEmail);\n  app.post(\"/api/bulk-send-email\", handleBulkSendEmail);\n\n  return app;\n}\n","import path from \"path\";\nimport { createServer } from \"./index\";\nimport * as express from \"express\";\n\nconst app = createServer();\nconst port = process.env.PORT || 3000;\n\n// In production, serve the built SPA files\nconst __dirname = import.meta.dirname;\nconst distPath = path.join(__dirname, \"../spa\");\n\n// Serve static files\napp.use(express.static(distPath));\n\n// Handle React Router - serve index.html for all non-API routes\napp.get(\"*\", (req, res) => {\n  // Don't serve index.html for API routes\n  if (req.path.startsWith(\"/api/\") || req.path.startsWith(\"/health\")) {\n    return res.status(404).json({ error: \"API endpoint not found\" });\n  }\n\n  res.sendFile(path.join(distPath, \"index.html\"));\n});\n\napp.listen(port, () => {\n  console.log(`üöÄ Fusion Starter server running on port ${port}`);\n  console.log(`üì± Frontend: http://localhost:${port}`);\n  console.log(`üîß API: http://localhost:${port}/api`);\n});\n\n// Graceful shutdown\nprocess.on(\"SIGTERM\", () => {\n  console.log(\"üõë Received SIGTERM, shutting down gracefully\");\n  process.exit(0);\n});\n\nprocess.on(\"SIGINT\", () => {\n  console.log(\"üõë Received SIGINT, shutting down gracefully\");\n  process.exit(0);\n});\n"],"names":["app","express"],"mappings":"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"}